# Git版本控制

## 版本控制工具

版本控制工具的意义

1. 有利于多人协作开发，提升开发效率和容错率。
2. 记录更改信息，改了代码却想不起来改了什么地方导致出错。
3. 版本回滚，后悔药，时光机。

版本控制工具主要有`svn`和`git`两种，目前`git`使用得更多，以下为`git`的基本使用方法。

### 配置用户信息

git安装完成之后，需要进行全局配置。

全局配置邮箱：`git config --global user.email "3027475580@qq.com"`，这里需要填写自己的邮箱，在查看更改记录的时候可以看到。

全局配置用户名： `git config --global user.name "愿不觉"`，这里需要填写自己的用户名，在查看更改记录的时候可以看到。

查看全局配置：`git config --global --list`

如果是针对当前仓库进行配置，只需去掉`--global`参数即可。

### 建立仓库

1. 新建项目目录。
2. 打开`git base`并进入这个目录，`git base`在安装`git`时会自动安装。
3. 输入`git init`命令把这个目录初始化为版本控制仓库，以下简称`仓库`。

如果需要值定目录，可以使用`git init <目录名称>`，将把指定目录初始化为仓库

### 暂存

改动了仓库下的文件之后需要暂存才可以进行提交， 不暂存就不能提交。

`git add <文件名>`， 暂存指定文件。

`git add .`，如果目录名使用 `.`，则暂存该目录下的所有文件。

### 提交

发生改动的文件暂存之后可以进行提交，需要填写提交信息，对改动进行说明。

`git commit -m "这是提交信息"`，提交信息需要用双引号括起来。

### 查看改动信息



### 提交记录

`git show <唯一标识符> <文件名>` ，查看指定提交记录的指定文件的提交记录。只写文件名参数则打印那个文件的最新的提交记录，不写则标识符参数则打印那个文件的的所有提交记录。两个参数都不写的话，则打印所有提交记录。

`git diff <文件名>`，查看指定文件的改动。

`git diff`，如果不加参数，则查看所有改动过的文件的改动细节。

`git log` ，显示所有提交记录的列表。

`git log --stat`, 使用vim的方式展示信息，需要按`wq`退出。

### 回滚

`git reset --hard <commit id>`, 更改版本到指定提交的版本。

`git reset --hart HEAD^`, 回滚到上个版本。

### 放弃更改

1. 没有暂存：

   `git checkout -- <文件名>`，放弃指定文件的更改。

   `git checkout .`，放弃所有文件的更改。

2. 已暂存，但没有提交：

   `git reset HEAD <文件名>`， 放弃指定文件的更改。

   `git reset HEAD`，放弃所有文件的更改。

3. 已提交：

   `git reset --hart HEAD^`, 回滚到上个版本，也起到撤销所以本次更改的作用。

## 远端仓库与协作开发

常用远端代码库网站有

1. github（全球最大的代码库，英文）
2. gitlab（公司常用的仓库，通常是自己部署的，中英）
3. gitee（码云，国产代码库，中文）

这里主要讲解github的远端仓库配置方法。

### 免密配置推送


1. 创建github账号。
2. 在本地执行命令`ssh-keygen -t rsa -b 4096 -C "邮箱地址"`，生成ssh密钥和公钥。
3. 在本地用户目录下找到`.ssh`目录，win10系统的默认目录是`C:\Users\Lansiny\.ssh`。
4. 在`.ssh`目录下，找到`id_rsa.pub`文件，这里记录公钥。
5. 点击github右上角的用户图标，打开`settings`页面，找到`SSH and GPG keys`选项。
6. 在`SSH Keys`位置添加公钥，粘贴`id_rsa.pub`的内容，如果不填`Title`，会自动填上ssh全局配置的邮箱。
7. 点击`Add SSH key`，配置完成。

### 创建远端仓库



### 克隆

`git clone <远端地址> <本地目录>`，可以从远端仓库把项目下载到指定的本地目录下。

`git clone <远端地址>`，如果不填本地目录参数就会下载到当前目录下。

### 远端仓库配置

从远端克隆下来的仓库自带远端仓库路径，无须配置。

`git remote -v`，克隆下来的仓库可以使用这个命令查看所有远端仓库信息。

`git remote show <远端仓库地址>`，查看某个远端仓库的信息。

如果是先在本地初始化的仓库，则需要指定远端仓库路径才可推送和拉取。

使用`git init` 初始化的本地仓库并没有远端仓库路径，需要手动添加。

`git remote add <仓库名称> <仓库路径>`，指定一个远端仓库的别名，并配置路径，本文的远端仓库名称是`origin`。

`git remote rm <要删除的远端仓库名称>`，删除指定的远端仓库配置，这里只是删除本地配置，并不影响远端仓库。

`git remote rename <要改名的仓库名称> <新的仓库名称>`，更改本地配置的远端仓库的名称，并不影响远端仓库。

### 分支

初始化仓库时不能马上创建分支，分支以提交记录为节点，至少提交一次才可以创建分支。

`git branch <分支名称>`，创建新分支。

`git switch <分支名称>`， 切换到指定分支。

`git checkout -b <分支名称>`，创建新分支，并切换到新分支，这是上面两个命令的简写。

`git branch`，查看所有分支， 带星号的是当前所处分支。

### 推送

`git push <远端仓库名称> <要推送的本地分支名称>`， 把本地分支推送到远端仓库。

`git branch -d <要删除的分支名称>`，删除本地分支， 假如这个分支未合并，则无法删除。

`git branch -D <要删除的分支名称>`，强制删除本地分支， 无论是否已合并

`git push origin --delete <要删除的分支名称>`，删除远端origin仓库的指定分支

第一次推送时可能会报错，说没有指定上游分支。

`git push origin master`，把master分支推送至origin仓库，无须提前指定上游分支。

`git push origin dev:master` ，把当前的dev分支推送到远端origin仓库的master分支。

`git push --set-upstream origin master`， 推送并指定origin仓库的master分支为上游分，以后就可以快捷推送。

`git push`，快捷推送， 把当前分支推送到上游分支, 需要先指定上游分支。

注意，在git创建新的仓库时，可以在页面中选择一些初始化配置，如`README.md`、` .gitignore`、`LICENSE`，如果有初始化配置，则需要先拉取一次才可以进行推送。如果是空仓库，可以直接推送。

### 拉取

`git pull origin master`， 拉取origin仓库的master分支，与本地分支合并。

如果远端有新的推送，则需要处理合并冲突，如果没有新的推送，则不需要处理合并冲突。

### 分支合并和冲突处理

