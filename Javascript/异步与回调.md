# 异步与回调

程序运行一般是`同步`（synchronous）的，即按照代码书写的顺序执行。

`异步`（asynchronous）与同步相对，即在前一个方法未执行完时，就开始运行后一个方法。

同步是顺序执行，异步是不完全按顺序执行。



#### 异步的优点

当这两个程序互相不关联的时候，异步运行可以提高运行的效率。



#### 使用场景

两个程序在一定时间内，可以是同时运行的。通常用于服务器的并发场景。如果服务器的程序都是同步的，并发就不会存在。



#### 阻塞与非阻塞

`阻塞`，是指一个程序没运行完，它后面的程序是无法运行的。而

`非阻塞`，指一个程序如果因为各种原因（IO、网络、代码量等）没运行完的时候，其他的程序也是可以继续运行的。



#### 单线程与多线程

`单线程`是指程序运行只有一个通道，不同的方法需要排队执行，容易产生阻塞。

`多线程`使得程序可以在不同的线程中运行，不会相互影响，可以实现非阻塞。很多语言都可以提供`多线程`的功能，相当于开了几个通道运行程序。



#### Javascript中的异步

js是一个单线程的语言，永远只有一个通道在运行程序，js中所谓的异步，应该被称为`伪异步`（pseudo asynchronous）。

比如在执行setTimeout方法后执行一个死循环，setTimeout方法是不会再执行的。这是因为js是单线程程序块按队列执行的特性，并不能像普通的异步一样，实现非阻塞和不干扰。



#### 异步与回调

js中可以把函数作为参数传入另一个函数，这个时候传入的函数就是另一个函数的回调函数。由于上文提到的js单线程程序块按队列执行的特性，js的异步实现通常需要使用回调函数，但回调不一定就是异步。

非异步回调：map()、sort()、 filter()

异步回调:  setTimeout()

示例：

```javascript
function A(fun) {
     fun()
     console.log('A')
}

function B(fun) {
     setTimeout(fun, 10)
     console.log('B')
}

function C(func) {
     func()
     console.log('C')
}

function D(func) {
     func()
     console.log('D')
}

function E() {
     console.log('E')
}

A(function () {
	B(function () {
		C(function () {
            D(function () {
				E()
            })
        })
    })
})

// 依次输出结果： BAEDC
```

